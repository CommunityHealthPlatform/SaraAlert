{
  "description": "SaraAlertProdFlow",
  "states": [
    {
      "name": "Trigger",
      "type": "trigger",
      "transitions": [
        {
          "event": "incomingMessage"
        },
        {
          "next": "say_incoming_call",
          "event": "incomingCall"
        },
        {
          "next": "split_on_language",
          "event": "incomingRequest"
        }
      ],
      "properties": {
        "offset": {
          "x": 1380,
          "y": -960
        }
      }
    },
    {
      "name": "sms_assessment_prompt",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "check_yes_no",
          "event": "incomingMessage"
        },
        {
          "next": "send_assessment_sms_no_response",
          "event": "timeout"
        },
        {
          "next": "send_assessment_sms_error",
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 250,
          "y": 480
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "{{flow.data.prompt}}",
        "timeout": 64800
      }
    },
    {
      "name": "send_assessment_data",
      "type": "make-http-request",
      "transitions": [
        {
          "next": "send_message_1",
          "event": "success"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 250,
          "y": 1560
        },
        "method": "POST",
        "content_type": "application/json;charset=utf-8",
        "body": "{\"response_status\": \"success_sms\", \n\"experiencing_symptoms\":\"{{widgets.sms_assessment_prompt.inbound.Body}}\", \"patient_submission_token\": \"{{flow.data.patient_submission_token}}\",\n\"threshold_hash\": \"{{flow.data.threshold_hash}}\"}",
        "url": "https://sara.public.saraalert.org/report/twilio"
      }
    },
    {
      "name": "check_yes_no",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "bad_response",
          "event": "noMatch"
        },
        {
          "next": "send_assessment_data",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of yes,Yes,no,No",
              "arguments": [
                "{{widgets.sms_assessment_prompt.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "yes,Yes,no,No,YES,NO,Yes.,No.,\"Yes\",\"No\",\"yes\",\"no\",\"Yes.\",\"No.\""
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.sms_assessment_prompt.inbound.Body}}",
        "offset": {
          "x": 260,
          "y": 910
        }
      }
    },
    {
      "name": "bad_response",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "check_yes_no_again",
          "event": "incomingMessage"
        },
        {
          "next": "send_assessment_sms_no_response",
          "event": "timeout"
        },
        {
          "next": "send_assessment_sms_error",
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": -670,
          "y": 1100
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "{{flow.data.try_again}}",
        "timeout": 3600
      }
    },
    {
      "name": "send_message_1",
      "type": "send-message",
      "transitions": [
        {
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 100,
          "y": 2000
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "{{flow.data.thanks}}"
      }
    },
    {
      "name": "check_yes_no_again",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "bad_response",
          "event": "noMatch"
        },
        {
          "next": "send_assessment_data_from_sms_retry",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of yes,Yes,no,No",
              "arguments": [
                "{{widgets.bad_response.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "yes,Yes,no,No,YES,NO,Yes.,No.,\"Yes\",\"No\",\"yes\",\"no\",\"Yes.\",\"No.\""
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.bad_response.inbound.Body}}",
        "offset": {
          "x": -270,
          "y": 1310
        }
      }
    },
    {
      "name": "send_assessment_data_from_sms_retry",
      "type": "make-http-request",
      "transitions": [
        {
          "next": "send_message_1",
          "event": "success"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": -60,
          "y": 1560
        },
        "method": "POST",
        "content_type": "application/json;charset=utf-8",
        "body": "{\"response_status\": \"success_sms\", \n\"experiencing_symptoms\":\"{{widgets.bad_response.inbound.Body}}\", \"patient_submission_token\": \"{{flow.data.patient_submission_token}}\",\n\"threshold_hash\": \"{{flow.data.threshold_hash}}\"}",
        "url": "https://sara.public.saraalert.org/report/twilio"
      }
    },
    {
      "name": "sms_or_voice_english_flow",
      "type": "split-based-on",
      "transitions": [
        {
          "event": "noMatch"
        },
        {
          "next": "sms_assessment_prompt",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to SMS",
              "arguments": [
                "{{flow.data.medium}}"
              ],
              "type": "equal_to",
              "value": "SMS"
            }
          ]
        },
        {
          "next": "call_user",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to VOICE",
              "arguments": [
                "{{flow.data.medium}}"
              ],
              "type": "equal_to",
              "value": "VOICE"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{flow.data.medium}}",
        "offset": {
          "x": 330,
          "y": 190
        }
      }
    },
    {
      "name": "call_user",
      "type": "make-outgoing-call-v2",
      "transitions": [
        {
          "next": "split_1",
          "event": "answered"
        },
        {
          "next": "voice_send_no_answer",
          "event": "busy"
        },
        {
          "next": "voice_send_no_answer",
          "event": "noAnswer"
        },
        {
          "next": "voice_send_error",
          "event": "failed"
        }
      ],
      "properties": {
        "machine_detection_speech_threshold": "2400",
        "detect_answering_machine": true,
        "offset": {
          "x": 1050,
          "y": 570
        },
        "recording_channels": "mono",
        "timeout": 60,
        "machine_detection": "Enable",
        "trim": "do-not-trim",
        "record": false,
        "machine_detection_speech_end_threshold": "1200",
        "machine_detection_timeout": "30",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "machine_detection_silence_timeout": "10000"
      }
    },
    {
      "name": "welcome_prompt",
      "type": "say-play",
      "transitions": [
        {
          "next": "voice_reply_to_prompt",
          "event": "audioComplete"
        }
      ],
      "properties": {
        "voice": "Polly.Joanna",
        "offset": {
          "x": 1050,
          "y": 1120
        },
        "loop": 1,
        "say": "{{flow.data.intro}}",
        "language": "en-US"
      }
    },
    {
      "name": "voice_reply_to_prompt",
      "type": "gather-input-on-call",
      "transitions": [
        {
          "event": "keypress"
        },
        {
          "next": "check_yes_no_voice",
          "event": "speech"
        },
        {
          "next": "say_lets_try_again",
          "event": "timeout"
        }
      ],
      "properties": {
        "voice": "Polly.Joanna",
        "speech_timeout": "auto",
        "offset": {
          "x": 1090,
          "y": 1340
        },
        "loop": 1,
        "hints": "yes, yeah, yup, no, nope, nah",
        "finish_on_key": "#",
        "say": "{{flow.data.prompt}}",
        "language": "en-US",
        "stop_gather": true,
        "gather_language": "en-US",
        "profanity_filter": "true",
        "timeout": 6
      }
    },
    {
      "name": "check_yes_no_voice",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "say_lets_try_again",
          "event": "noMatch"
        },
        {
          "next": "voice_send_assessment_data",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of yes,Yes,no,No",
              "arguments": [
                "{{widgets.voice_reply_to_prompt.SpeechResult}}"
              ],
              "type": "matches_any_of",
              "value": "yes,Yes,no,No,Yes.,No.,Yeah,yeah,Yeah."
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.voice_reply_to_prompt.SpeechResult}}",
        "offset": {
          "x": 1090,
          "y": 1670
        }
      }
    },
    {
      "name": "voice_send_assessment_data",
      "type": "make-http-request",
      "transitions": [
        {
          "next": "thank_you_voice",
          "event": "success"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 1410,
          "y": 1920
        },
        "method": "POST",
        "content_type": "application/json;charset=utf-8",
        "body": "{\"response_status\": \"success_voice\", \n\"experiencing_symptoms\":\"{{widgets.voice_reply_to_prompt.SpeechResult}}\", \"patient_submission_token\": \"{{flow.data.patient_submission_token}}\",\n\"threshold_hash\": \"{{flow.data.threshold_hash}}\"}",
        "url": "https://sara.public.saraalert.org/report/twilio"
      }
    },
    {
      "name": "thank_you_voice",
      "type": "say-play",
      "transitions": [
        {
          "event": "audioComplete"
        }
      ],
      "properties": {
        "voice": "Polly.Joanna",
        "offset": {
          "x": 1420,
          "y": 2180
        },
        "loop": 1,
        "say": "{{flow.data.thanks}}",
        "language": "en-US"
      }
    },
    {
      "name": "say_lets_try_again",
      "type": "say-play",
      "transitions": [
        {
          "next": "voice_reply_to_prompt",
          "event": "audioComplete"
        }
      ],
      "properties": {
        "voice": "Polly.Joanna",
        "offset": {
          "x": 2000,
          "y": 1350
        },
        "loop": 1,
        "say": "{{flow.data.try_again}}",
        "language": "en-US"
      }
    },
    {
      "name": "voice_send_no_answer",
      "type": "make-http-request",
      "transitions": [
        {
          "event": "success"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 1890,
          "y": 1090
        },
        "method": "POST",
        "content_type": "application/json;charset=utf-8",
        "body": "{\"response_status\": \"no_answer_voice\", \"patient_submission_token\": \"{{flow.data.patient_submission_token}}\",\n\"threshold_hash\": \"{{flow.data.threshold_hash}}\"}",
        "url": "https://sara.public.saraalert.org/report/twilio"
      }
    },
    {
      "name": "split_1",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "voice_send_no_answer",
          "event": "noMatch"
        },
        {
          "next": "welcome_prompt",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to human",
              "arguments": [
                "{{widgets.call_user.AnsweredBy}}"
              ],
              "type": "matches_any_of",
              "value": "human, unknown"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.call_user.AnsweredBy}}",
        "offset": {
          "x": 870,
          "y": 850
        }
      }
    },
    {
      "name": "send_assessment_sms_no_response",
      "type": "make-http-request",
      "transitions": [
        {
          "event": "success"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": -360,
          "y": 740
        },
        "method": "POST",
        "content_type": "application/json;charset=utf-8",
        "body": "{\"response_status\": \"no_answer_sms\", \n\"patient_submission_token\": \"{{flow.data.patient_submission_token}}\",\n\"threshold_hash\": \"{{flow.data.threshold_hash}}\"}",
        "url": "https://sara.public.saraalert.org/report/twilio"
      }
    },
    {
      "name": "send_assessment_sms_error",
      "type": "make-http-request",
      "transitions": [
        {
          "event": "success"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": -1270,
          "y": 1320
        },
        "method": "POST",
        "content_type": "application/json;charset=utf-8",
        "body": "{\"response_status\": \"error_sms\", \n\"patient_submission_token\": \"{{flow.data.patient_submission_token}}\",\n\"threshold_hash\": \"{{flow.data.threshold_hash}}\"}",
        "url": "https://sara.public.saraalert.org/report/twilio"
      }
    },
    {
      "name": "voice_send_error",
      "type": "make-http-request",
      "transitions": [
        {
          "event": "success"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 1970,
          "y": 830
        },
        "method": "POST",
        "content_type": "application/json;charset=utf-8",
        "body": "{\"response_status\": \"error_voice\", \"patient_submission_token\": \"{{flow.data.patient_submission_token}}\",\n\"threshold_hash\": \"{{flow.data.threshold_hash}}\"}",
        "url": "https://sara.public.saraalert.org/report/twilio"
      }
    },
    {
      "name": "say_incoming_call",
      "type": "say-play",
      "transitions": [
        {
          "event": "audioComplete"
        }
      ],
      "properties": {
        "offset": {
          "x": 1340,
          "y": -520
        },
        "loop": 1,
        "say": "Hello, you have reached Sara Alert outside of your daily report requirement, please contact your public health department directly if you are experiencing symptoms."
      }
    },
    {
      "name": "split_on_language",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "sms_or_voice_english_flow",
          "event": "noMatch"
        },
        {
          "next": "sms_or_voice_english_flow",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to EN",
              "arguments": [
                "{{flow.data.language}}"
              ],
              "type": "equal_to",
              "value": "EN"
            }
          ]
        },
        {
          "next": "sms_or_voice_spanish_flow",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to ES",
              "arguments": [
                "{{flow.data.language}}"
              ],
              "type": "equal_to",
              "value": "ES"
            }
          ]
        },
        {
          "next": "sms_or_voice_french_flow",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to FR",
              "arguments": [
                "{{flow.data.language}}"
              ],
              "type": "equal_to",
              "value": "FR"
            }
          ]
        },
        {
          "next": "sms_or_voice_somali_flow",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to SO",
              "arguments": [
                "{{flow.data.language}}"
              ],
              "type": "equal_to",
              "value": "SO"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{flow.data.language}}",
        "offset": {
          "x": 1721,
          "y": -349
        }
      }
    },
    {
      "name": "sms_or_voice_spanish_flow",
      "type": "split-based-on",
      "transitions": [
        {
          "event": "noMatch"
        },
        {
          "next": "sms_assessment_spanish_prompt",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to SMS",
              "arguments": [
                "{{flow.data.medium}}"
              ],
              "type": "equal_to",
              "value": "SMS"
            }
          ]
        },
        {
          "next": "call_user_spanish",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to VOICE",
              "arguments": [
                "{{flow.data.medium}}"
              ],
              "type": "equal_to",
              "value": "VOICE"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{flow.data.medium}}",
        "offset": {
          "x": 4020,
          "y": 110
        }
      }
    },
    {
      "name": "sms_assessment_spanish_prompt",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "check_yes_no_spanish",
          "event": "incomingMessage"
        },
        {
          "next": "send_assessment_sms_no_response_spanish",
          "event": "timeout"
        },
        {
          "next": "send_assessment_sms_error_spanish",
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 3510,
          "y": 580
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "{{flow.data.prompt}}",
        "timeout": 64800
      }
    },
    {
      "name": "call_user_spanish",
      "type": "make-outgoing-call-v2",
      "transitions": [
        {
          "next": "voice_split_spanish",
          "event": "answered"
        },
        {
          "event": "busy"
        },
        {
          "next": "voice_send_no_answer_spanish",
          "event": "noAnswer"
        },
        {
          "next": "voice_send_error_spanish",
          "event": "failed"
        }
      ],
      "properties": {
        "machine_detection_speech_threshold": "2400",
        "detect_answering_machine": true,
        "offset": {
          "x": 4650,
          "y": 470
        },
        "recording_channels": "mono",
        "timeout": 60,
        "machine_detection": "Enable",
        "trim": "do-not-trim",
        "record": false,
        "machine_detection_speech_end_threshold": "1200",
        "machine_detection_timeout": "30",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "machine_detection_silence_timeout": "10000"
      }
    },
    {
      "name": "send_assessment_sms_no_response_spanish",
      "type": "make-http-request",
      "transitions": [
        {
          "event": "success"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 2590,
          "y": 1230
        },
        "method": "POST",
        "content_type": "application/json;charset=utf-8",
        "body": "{\"response_status\": \"no_answer_sms\", \n\"patient_submission_token\": \"{{flow.data.patient_submission_token}}\",\n\"threshold_hash\": \"{{flow.data.threshold_hash}}\"}",
        "url": "https://sara.public.saraalert.org/report/twilio"
      }
    },
    {
      "name": "check_yes_no_spanish",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "bad_response_spanish",
          "event": "noMatch"
        },
        {
          "next": "send_assessment_data_spanish_yes",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of si,Si",
              "arguments": [
                "{{widgets.sms_assessment_spanish_prompt.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "si, Si, sí, SI, SÍ"
            }
          ]
        },
        {
          "next": "send_assessment_data_from_sms_no",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of no, No",
              "arguments": [
                "{{widgets.sms_assessment_spanish_prompt.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "no, No, NO"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.sms_assessment_spanish_prompt.inbound.Body}}",
        "offset": {
          "x": 3950,
          "y": 860
        }
      }
    },
    {
      "name": "bad_response_spanish",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "check_yes_no_again_spanish",
          "event": "incomingMessage"
        },
        {
          "next": "send_assessment_sms_no_response_spanish",
          "event": "timeout"
        },
        {
          "next": "send_assessment_sms_error_spanish",
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 3510,
          "y": 1110
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "{{flow.data.try_again}}",
        "timeout": 3600
      }
    },
    {
      "name": "send_assessment_sms_error_spanish",
      "type": "make-http-request",
      "transitions": [
        {
          "event": "success"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 2930,
          "y": 1230
        },
        "method": "POST",
        "content_type": "application/json;charset=utf-8",
        "body": "{\"response_status\": \"error_sms\", \n\"patient_submission_token\": \"{{flow.data.patient_submission_token}}\",\n\"threshold_hash\": \"{{flow.data.threshold_hash}}\"}",
        "url": "https://sara.public.saraalert.org/report/twilio"
      }
    },
    {
      "name": "check_yes_no_again_spanish",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "bad_response_spanish",
          "event": "noMatch"
        },
        {
          "next": "send_assessment_data_spanish_yes",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of si,Si",
              "arguments": [
                "{{widgets.bad_response_spanish.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "si, Si, sí, SI, SÍ"
            }
          ]
        },
        {
          "next": "send_assessment_data_from_sms_no",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of no, No",
              "arguments": [
                "{{widgets.bad_response_spanish.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "no, No, NO"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.bad_response_spanish.inbound.Body}}",
        "offset": {
          "x": 3390,
          "y": 1380
        }
      }
    },
    {
      "name": "send_assessment_data_from_sms_no",
      "type": "make-http-request",
      "transitions": [
        {
          "next": "send_thank_you_spanish",
          "event": "success"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 3430,
          "y": 2130
        },
        "method": "POST",
        "content_type": "application/json;charset=utf-8",
        "body": "{\"response_status\": \"success_sms\", \n\"experiencing_symptoms\":\"No\", \"patient_submission_token\": \"{{flow.data.patient_submission_token}}\",\n\"threshold_hash\": \"{{flow.data.threshold_hash}}\"}",
        "url": "https://sara.public.saraalert.org/report/twilio"
      }
    },
    {
      "name": "send_assessment_data_spanish_yes",
      "type": "make-http-request",
      "transitions": [
        {
          "next": "send_thank_you_spanish",
          "event": "success"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 4010,
          "y": 2130
        },
        "method": "POST",
        "content_type": "application/json;charset=utf-8",
        "body": "{\"response_status\": \"success_sms\", \n\"experiencing_symptoms\":\"Yes\", \"patient_submission_token\": \"{{flow.data.patient_submission_token}}\",\n\"threshold_hash\": \"{{flow.data.threshold_hash}}\"}",
        "url": "https://sara.public.saraalert.org/report/twilio"
      }
    },
    {
      "name": "send_thank_you_spanish",
      "type": "send-message",
      "transitions": [
        {
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 3680,
          "y": 2430
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "{{flow.data.thanks}}"
      }
    },
    {
      "name": "voice_split_spanish",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "voice_send_no_answer_spanish",
          "event": "noMatch"
        },
        {
          "next": "welcome_prompt_spanish",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to human",
              "arguments": [
                "{{widgets.call_user_spanish.AnsweredBy}}"
              ],
              "type": "matches_any_of",
              "value": "human, unknown"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.call_user_spanish.AnsweredBy}}",
        "offset": {
          "x": 4670,
          "y": 850
        }
      }
    },
    {
      "name": "voice_send_error_spanish",
      "type": "make-http-request",
      "transitions": [
        {
          "event": "success"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 5560,
          "y": 1050
        },
        "method": "POST",
        "content_type": "application/json;charset=utf-8",
        "body": "{\"response_status\": \"error_voice\", \"patient_submission_token\": \"{{flow.data.patient_submission_token}}\",\n\"threshold_hash\": \"{{flow.data.threshold_hash}}\"}",
        "url": "https://sara.public.saraalert.org/report/twilio"
      }
    },
    {
      "name": "voice_send_no_answer_spanish",
      "type": "make-http-request",
      "transitions": [
        {
          "event": "success"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 5220,
          "y": 1060
        },
        "method": "POST",
        "content_type": "application/json;charset=utf-8",
        "body": "{\"response_status\": \"no_answer_voice\", \"patient_submission_token\": \"{{flow.data.patient_submission_token}}\",\n\"threshold_hash\": \"{{flow.data.threshold_hash}}\"}",
        "url": "https://sara.public.saraalert.org/report/twilio"
      }
    },
    {
      "name": "welcome_prompt_spanish",
      "type": "say-play",
      "transitions": [
        {
          "next": "voice_reply_to_prompt_spanish",
          "event": "audioComplete"
        }
      ],
      "properties": {
        "voice": "Polly.Conchita",
        "offset": {
          "x": 4850,
          "y": 1121
        },
        "loop": 1,
        "say": "{{flow.data.intro}}",
        "language": "es-ES"
      }
    },
    {
      "name": "voice_reply_to_prompt_spanish",
      "type": "gather-input-on-call",
      "transitions": [
        {
          "event": "keypress"
        },
        {
          "next": "check_yes_no_voice_spanish",
          "event": "speech"
        },
        {
          "next": "lets_try_again_spanish",
          "event": "timeout"
        }
      ],
      "properties": {
        "voice": "Polly.Conchita",
        "speech_timeout": "auto",
        "offset": {
          "x": 4880,
          "y": 1370
        },
        "loop": 1,
        "hints": "si, no",
        "finish_on_key": "#",
        "say": "{{flow.data.prompt}}",
        "language": "es-ES",
        "stop_gather": true,
        "gather_language": "es-ES",
        "profanity_filter": "true",
        "timeout": 6
      }
    },
    {
      "name": "lets_try_again_spanish",
      "type": "say-play",
      "transitions": [
        {
          "next": "voice_reply_to_prompt_spanish",
          "event": "audioComplete"
        }
      ],
      "properties": {
        "voice": "Polly.Conchita",
        "offset": {
          "x": 5930,
          "y": 1370
        },
        "loop": 1,
        "say": "{{flow.data.try_again}}",
        "language": "es-ES"
      }
    },
    {
      "name": "check_yes_no_voice_spanish",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "lets_try_again_spanish",
          "event": "noMatch"
        },
        {
          "next": "voice_send_assessment_spanish_yes",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of si, Si",
              "arguments": [
                "{{widgets.voice_reply_to_prompt_spanish.SpeechResult}}"
              ],
              "type": "matches_any_of",
              "value": "si, Si"
            }
          ]
        },
        {
          "next": "voice_send_assessment_spanish_no",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of no, No",
              "arguments": [
                "{{widgets.voice_reply_to_prompt_spanish.SpeechResult}}"
              ],
              "type": "matches_any_of",
              "value": "no, No, NO"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.voice_reply_to_prompt_spanish.SpeechResult}}",
        "offset": {
          "x": 4890,
          "y": 1670
        }
      }
    },
    {
      "name": "voice_send_assessment_spanish_yes",
      "type": "make-http-request",
      "transitions": [
        {
          "next": "thank_you_voice_spanish",
          "event": "success"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 4880,
          "y": 2060
        },
        "method": "POST",
        "content_type": "application/json;charset=utf-8",
        "body": "{\"response_status\": \"success_voice\", \n\"experiencing_symptoms\":\"Yes\", \"patient_submission_token\": \"{{flow.data.patient_submission_token}}\",\n\"threshold_hash\": \"{{flow.data.threshold_hash}}\"}",
        "url": "https://sara.public.saraalert.org/report/twilio"
      }
    },
    {
      "name": "thank_you_voice_spanish",
      "type": "say-play",
      "transitions": [
        {
          "event": "audioComplete"
        }
      ],
      "properties": {
        "voice": "Polly.Conchita",
        "offset": {
          "x": 5130,
          "y": 2380
        },
        "loop": 1,
        "say": "{{flow.data.thanks}}",
        "language": "es-ES"
      }
    },
    {
      "name": "voice_send_assessment_spanish_no",
      "type": "make-http-request",
      "transitions": [
        {
          "next": "thank_you_voice_spanish",
          "event": "success"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 5350,
          "y": 2050
        },
        "method": "POST",
        "content_type": "application/json;charset=utf-8",
        "body": "{\"response_status\": \"success_voice\", \n\"experiencing_symptoms\":\"No\", \"patient_submission_token\": \"{{flow.data.patient_submission_token}}\",\n\"threshold_hash\": \"{{flow.data.threshold_hash}}\"}",
        "url": "https://sara.public.saraalert.org/report/twilio"
      }
    },
    {
      "name": "sms_or_voice_french_flow",
      "type": "split-based-on",
      "transitions": [
        {
          "event": "noMatch"
        },
        {
          "next": "sms_assessment_french_prompt",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to SMS",
              "arguments": [
                "{{flow.data.medium}}"
              ],
              "type": "equal_to",
              "value": "SMS"
            }
          ]
        },
        {
          "next": "call_user_french",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to VOICE",
              "arguments": [
                "{{flow.data.medium}}"
              ],
              "type": "equal_to",
              "value": "VOICE"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{flow.data.medium}}",
        "offset": {
          "x": 7990,
          "y": 80
        }
      }
    },
    {
      "name": "sms_assessment_french_prompt",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "check_yes_no_french",
          "event": "incomingMessage"
        },
        {
          "next": "send_assessment_sms_no_response_french",
          "event": "timeout"
        },
        {
          "next": "send_assessment_sms_error_french",
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 7480,
          "y": 550
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "{{flow.data.prompt}}",
        "timeout": 64800
      }
    },
    {
      "name": "call_user_french",
      "type": "make-outgoing-call-v2",
      "transitions": [
        {
          "next": "voice_split_french",
          "event": "answered"
        },
        {
          "event": "busy"
        },
        {
          "next": "voice_send_no_answer_french",
          "event": "noAnswer"
        },
        {
          "next": "voice_send_error_french",
          "event": "failed"
        }
      ],
      "properties": {
        "machine_detection_speech_threshold": "2400",
        "detect_answering_machine": true,
        "offset": {
          "x": 8620,
          "y": 440
        },
        "recording_channels": "mono",
        "timeout": 60,
        "machine_detection": "Enable",
        "trim": "do-not-trim",
        "record": false,
        "machine_detection_speech_end_threshold": "1200",
        "machine_detection_timeout": "30",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "machine_detection_silence_timeout": "10000"
      }
    },
    {
      "name": "check_yes_no_french",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "bad_response_french",
          "event": "noMatch"
        },
        {
          "next": "french_send_assessment_data_from_sms_no",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of_non",
              "arguments": [
                "{{widgets.sms_assessment_french_prompt.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "Non, non, NON, Non. NON., non."
            }
          ]
        },
        {
          "next": "french_send_assessment_data_yes",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of_oui",
              "arguments": [
                "{{widgets.sms_assessment_french_prompt.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "oui, OUI, Oui, oui.,OUI.,Oui."
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.sms_assessment_french_prompt.inbound.Body}}",
        "offset": {
          "x": 7920,
          "y": 830
        }
      }
    },
    {
      "name": "voice_split_french",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "voice_send_no_answer_french",
          "event": "noMatch"
        },
        {
          "next": "welcome_prompt_french",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to human",
              "arguments": [
                "{{widgets.call_user_french.AnsweredBy}}"
              ],
              "type": "matches_any_of",
              "value": "human, unknown"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.call_user_french.AnsweredBy}}",
        "offset": {
          "x": 8640,
          "y": 820
        }
      }
    },
    {
      "name": "send_assessment_sms_no_response_french",
      "type": "make-http-request",
      "transitions": [
        {
          "event": "success"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 6560,
          "y": 1200
        },
        "method": "POST",
        "content_type": "application/json;charset=utf-8",
        "body": "{\"response_status\": \"no_answer_sms\", \n\"patient_submission_token\": \"{{flow.data.patient_submission_token}}\",\n\"threshold_hash\": \"{{flow.data.threshold_hash}}\"}",
        "url": "https://sara.public.saraalert.org/report/twilio"
      }
    },
    {
      "name": "send_assessment_sms_error_french",
      "type": "make-http-request",
      "transitions": [
        {
          "event": "success"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 6900,
          "y": 1200
        },
        "method": "POST",
        "content_type": "application/json;charset=utf-8",
        "body": "{\"response_status\": \"error_sms\", \n\"patient_submission_token\": \"{{flow.data.patient_submission_token}}\",\n\"threshold_hash\": \"{{flow.data.threshold_hash}}\"}",
        "url": "https://sara.public.saraalert.org/report/twilio"
      }
    },
    {
      "name": "bad_response_french",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "check_yes_no_again_french",
          "event": "incomingMessage"
        },
        {
          "next": "send_assessment_sms_no_response_french",
          "event": "timeout"
        },
        {
          "next": "send_assessment_sms_error_french",
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 7660,
          "y": 1080
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "{{flow.data.try_again}}",
        "timeout": 3600
      }
    },
    {
      "name": "welcome_prompt_french",
      "type": "say-play",
      "transitions": [
        {
          "next": "voice_reply_to_prompt_french",
          "event": "audioComplete"
        }
      ],
      "properties": {
        "voice": "Polly.Chantal",
        "offset": {
          "x": 8820,
          "y": 1090
        },
        "loop": 1,
        "say": "{{flow.data.intro}}",
        "language": "fr-CA"
      }
    },
    {
      "name": "voice_send_no_answer_french",
      "type": "make-http-request",
      "transitions": [
        {
          "event": "success"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 9190,
          "y": 1030
        },
        "method": "POST",
        "content_type": "application/json;charset=utf-8",
        "body": "{\"response_status\": \"no_answer_voice\", \"patient_submission_token\": \"{{flow.data.patient_submission_token}}\",\n\"threshold_hash\": \"{{flow.data.threshold_hash}}\"}",
        "url": "https://sara.public.saraalert.org/report/twilio"
      }
    },
    {
      "name": "voice_send_error_french",
      "type": "make-http-request",
      "transitions": [
        {
          "event": "success"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 9710,
          "y": 1040
        },
        "method": "POST",
        "content_type": "application/json;charset=utf-8",
        "body": "{\"response_status\": \"error_voice\", \"patient_submission_token\": \"{{flow.data.patient_submission_token}}\",\n\"threshold_hash\": \"{{flow.data.threshold_hash}}\"}",
        "url": "https://sara.public.saraalert.org/report/twilio"
      }
    },
    {
      "name": "check_yes_no_again_french",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "bad_response_french",
          "event": "noMatch"
        },
        {
          "next": "french_send_assessment_data_yes",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of oui",
              "arguments": [
                "{{widgets.bad_response_french.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "oui, OUI, Oui, oui.,OUI.,Oui."
            }
          ]
        },
        {
          "next": "french_send_assessment_data_from_sms_no",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of non",
              "arguments": [
                "{{widgets.bad_response_french.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "Non, non, NON, Non. NON., non."
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.bad_response_french.inbound.Body}}",
        "offset": {
          "x": 7550,
          "y": 1420
        }
      }
    },
    {
      "name": "voice_reply_to_prompt_french",
      "type": "gather-input-on-call",
      "transitions": [
        {
          "event": "keypress"
        },
        {
          "next": "check_yes_no_voice_french",
          "event": "speech"
        },
        {
          "next": "lets_try_again_french",
          "event": "timeout"
        }
      ],
      "properties": {
        "voice": "Polly.Chantal",
        "speech_timeout": "auto",
        "offset": {
          "x": 8850,
          "y": 1340
        },
        "loop": 1,
        "hints": "si, no",
        "finish_on_key": "#",
        "say": "{{flow.data.prompt}}",
        "language": "fr-CA",
        "stop_gather": true,
        "gather_language": "es-ES",
        "profanity_filter": "true",
        "timeout": 6
      }
    },
    {
      "name": "lets_try_again_french",
      "type": "say-play",
      "transitions": [
        {
          "next": "voice_reply_to_prompt_french",
          "event": "audioComplete"
        }
      ],
      "properties": {
        "voice": "Polly.Chantal",
        "offset": {
          "x": 9920,
          "y": 1380
        },
        "loop": 1,
        "say": "{{flow.data.try_again}}",
        "language": "fr-CA"
      }
    },
    {
      "name": "french_send_assessment_data_from_sms_no",
      "type": "make-http-request",
      "transitions": [
        {
          "next": "send_thank_you_french",
          "event": "success"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 7400,
          "y": 2100
        },
        "method": "POST",
        "content_type": "application/json;charset=utf-8",
        "body": "{\"response_status\": \"success_sms\", \n\"experiencing_symptoms\":\"No\", \"patient_submission_token\": \"{{flow.data.patient_submission_token}}\",\n\"threshold_hash\": \"{{flow.data.threshold_hash}}\"}",
        "url": "https://sara.public.saraalert.org/report/twilio"
      }
    },
    {
      "name": "french_send_assessment_data_yes",
      "type": "make-http-request",
      "transitions": [
        {
          "next": "send_thank_you_french",
          "event": "success"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 7980,
          "y": 2100
        },
        "method": "POST",
        "content_type": "application/json;charset=utf-8",
        "body": "{\"response_status\": \"success_sms\", \n\"experiencing_symptoms\":\"Yes\", \"patient_submission_token\": \"{{flow.data.patient_submission_token}}\",\n\"threshold_hash\": \"{{flow.data.threshold_hash}}\"}",
        "url": "https://sara.public.saraalert.org/report/twilio"
      }
    },
    {
      "name": "send_thank_you_french",
      "type": "send-message",
      "transitions": [
        {
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 7700,
          "y": 2490
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "{{flow.data.thanks}}"
      }
    },
    {
      "name": "check_yes_no_voice_french",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "lets_try_again_french",
          "event": "noMatch"
        },
        {
          "next": "voice_send_assessment_french_yes",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of oui",
              "arguments": [
                "{{widgets.voice_reply_to_prompt_french.SpeechResult}}"
              ],
              "type": "matches_any_of",
              "value": "oui, OUI, Oui, oui.,OUI.,Oui."
            }
          ]
        },
        {
          "next": "voice_send_assessment_french_no",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of non",
              "arguments": [
                "{{widgets.voice_reply_to_prompt_french.SpeechResult}}"
              ],
              "type": "matches_any_of",
              "value": "Non, non, NON, Non. NON., non."
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.voice_reply_to_prompt_french.SpeechResult}}",
        "offset": {
          "x": 8860,
          "y": 1640
        }
      }
    },
    {
      "name": "voice_send_assessment_french_yes",
      "type": "make-http-request",
      "transitions": [
        {
          "next": "thank_you_voice_french",
          "event": "success"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 8850,
          "y": 2030
        },
        "method": "POST",
        "content_type": "application/json;charset=utf-8",
        "body": "{\"response_status\": \"success_voice\", \n\"experiencing_symptoms\":\"Yes\", \"patient_submission_token\": \"{{flow.data.patient_submission_token}}\",\n\"threshold_hash\": \"{{flow.data.threshold_hash}}\"}",
        "url": "https://sara.public.saraalert.org/report/twilio"
      }
    },
    {
      "name": "voice_send_assessment_french_no",
      "type": "make-http-request",
      "transitions": [
        {
          "next": "thank_you_voice_french",
          "event": "success"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 9320,
          "y": 2020
        },
        "method": "POST",
        "content_type": "application/json;charset=utf-8",
        "body": "{\"response_status\": \"success_voice\", \n\"experiencing_symptoms\":\"No\", \"patient_submission_token\": \"{{flow.data.patient_submission_token}}\",\n\"threshold_hash\": \"{{flow.data.threshold_hash}}\"}",
        "url": "https://sara.public.saraalert.org/report/twilio"
      }
    },
    {
      "name": "thank_you_voice_french",
      "type": "say-play",
      "transitions": [
        {
          "event": "audioComplete"
        }
      ],
      "properties": {
        "voice": "Polly.Chantal",
        "offset": {
          "x": 9100,
          "y": 2350
        },
        "loop": 1,
        "say": "{{flow.data.thanks}}",
        "language": "fr-CA"
      }
    },
    {
      "name": "sms_or_voice_somali_flow",
      "type": "split-based-on",
      "transitions": [
        {
          "event": "noMatch"
        },
        {
          "next": "sms_assessment_somali_prompt",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to SMS",
              "arguments": [
                "{{flow.data.medium}}"
              ],
              "type": "equal_to",
              "value": "SMS"
            }
          ]
        },
        {
          "next": "voice_send_error_somali",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to VOICE",
              "arguments": [
                "{{flow.data.medium}}"
              ],
              "type": "equal_to",
              "value": "VOICE"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{flow.data.medium}}",
        "offset": {
          "x": 11840,
          "y": 120
        }
      }
    },
    {
      "name": "sms_assessment_somali_prompt",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "check_yes_no_somali",
          "event": "incomingMessage"
        },
        {
          "next": "send_assessment_sms_no_response_somali",
          "event": "timeout"
        },
        {
          "next": "send_assessment_sms_error_somali",
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 11400,
          "y": 630
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "{{flow.data.prompt}}",
        "timeout": 64800
      }
    },
    {
      "name": "check_yes_no_somali",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "bad_response_somali",
          "event": "noMatch"
        },
        {
          "next": "somali_send_assessment_data_yes",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of Haa",
              "arguments": [
                "{{widgets.sms_assessment_somali_prompt.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "Haa, HAA,Haa.,HAA."
            }
          ]
        },
        {
          "next": "somali_send_assessment_data_from_sms_no",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of maya",
              "arguments": [
                "{{widgets.sms_assessment_somali_prompt.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "Maya, MAYA, maya, Maya., maya., MAYA."
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.sms_assessment_somali_prompt.inbound.Body}}",
        "offset": {
          "x": 12130,
          "y": 780
        }
      }
    },
    {
      "name": "bad_response_somali",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "check_yes_no_again_somali",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 11400,
          "y": 1160
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "{{flow.data.try_again}}",
        "timeout": 3600
      }
    },
    {
      "name": "send_assessment_sms_error_somali",
      "type": "make-http-request",
      "transitions": [
        {
          "event": "success"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 10820,
          "y": 1280
        },
        "method": "POST",
        "content_type": "application/json;charset=utf-8",
        "body": "{\"response_status\": \"error_sms\", \n\"patient_submission_token\": \"{{flow.data.patient_submission_token}}\",\n\"threshold_hash\": \"{{flow.data.threshold_hash}}\"}",
        "url": "https://sara.public.saraalert.org/report/twilio"
      }
    },
    {
      "name": "send_assessment_sms_no_response_somali",
      "type": "make-http-request",
      "transitions": [
        {
          "event": "success"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 10480,
          "y": 1280
        },
        "method": "POST",
        "content_type": "application/json;charset=utf-8",
        "body": "{\"response_status\": \"no_answer_sms\", \n\"patient_submission_token\": \"{{flow.data.patient_submission_token}}\",\n\"threshold_hash\": \"{{flow.data.threshold_hash}}\"}",
        "url": "https://sara.public.saraalert.org/report/twilio"
      }
    },
    {
      "name": "check_yes_no_again_somali",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "bad_response_somali",
          "event": "noMatch"
        },
        {
          "next": "somali_send_assessment_data_yes",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of Haa",
              "arguments": [
                "{{widgets.bad_response_somali.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "Haa, HAA,Haa.,HAA."
            }
          ]
        },
        {
          "next": "somali_send_assessment_data_from_sms_no",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of Maya",
              "arguments": [
                "{{widgets.bad_response_somali.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "Maya, MAYA, maya, Maya., maya., MAYA."
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.bad_response_somali.inbound.Body}}",
        "offset": {
          "x": 11400,
          "y": 1540
        }
      }
    },
    {
      "name": "somali_send_assessment_data_from_sms_no",
      "type": "make-http-request",
      "transitions": [
        {
          "next": "send_thank_you_somali",
          "event": "success"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 11980,
          "y": 2070
        },
        "method": "POST",
        "content_type": "application/json;charset=utf-8",
        "body": "{\"response_status\": \"success_sms\", \n\"experiencing_symptoms\":\"No\", \"patient_submission_token\": \"{{flow.data.patient_submission_token}}\",\n\"threshold_hash\": \"{{flow.data.threshold_hash}}\"}",
        "url": "https://sara.public.saraalert.org/report/twilio"
      }
    },
    {
      "name": "somali_send_assessment_data_yes",
      "type": "make-http-request",
      "transitions": [
        {
          "next": "send_thank_you_somali",
          "event": "success"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 11620,
          "y": 2080
        },
        "method": "POST",
        "content_type": "application/json;charset=utf-8",
        "body": "{\"response_status\": \"success_sms\", \n\"experiencing_symptoms\":\"Yes\", \"patient_submission_token\": \"{{flow.data.patient_submission_token}}\",\n\"threshold_hash\": \"{{flow.data.threshold_hash}}\"}",
        "url": "https://sara.public.saraalert.org/report/twilio"
      }
    },
    {
      "name": "send_thank_you_somali",
      "type": "send-message",
      "transitions": [
        {
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 11820,
          "y": 2540
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "{{flow.data.thanks}}"
      }
    },
    {
      "name": "voice_send_error_somali",
      "type": "make-http-request",
      "transitions": [
        {
          "event": "success"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 12180,
          "y": 510
        },
        "method": "POST",
        "content_type": "application/json;charset=utf-8",
        "body": "{\"response_status\": \"error_voice\", \"patient_submission_token\": \"{{flow.data.patient_submission_token}}\",\n\"threshold_hash\": \"{{flow.data.threshold_hash}}\"}",
        "url": "https://sara.public.saraalert.org/report/twilio"
      }
    }
  ],
  "initial_state": "Trigger",
  "flags": {
    "allow_concurrent_calls": true
  }
}